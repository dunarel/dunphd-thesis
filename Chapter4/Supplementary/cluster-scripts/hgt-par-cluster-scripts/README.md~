### hgt-par-cluster-scripts

These scripts are used to generate and submit parallel jobs on the Calcul Quebec MP2 cluster.

- When enlarging our study to the Partial Horizontal Gene Transfer, we faced an increased number of windows, in the thousands. 
We therefore developed our own task scheduler, to take better advantage of the "qsub" standard submission system and reduce the number of concurrent jobs.

These are composed of:
 [hgt/raxml/exec/sched-jobs-hgt-raxml.rb](hgt/raxml/exec/sched-jobs-hgt-raxml.rb) which schedules tasks.
 [hgt/raxml/exec/win-task-hgt-raxml.rb](hgt/raxml/exec/win-task-hgt-raxml.rb) which executes one task.

 The rest of the scripts are in:
- [hgt/raxml/](hgt/raxml/) contains the script to run RAxML Maximum Likelihood tree inference.





As this version is already parallelized using threads, we used the regular __qsub__ submission.

- [hgt-com-raxml](hgt-com-raxml/) contains the scripts to run HGT-Detection for HGT inference. 
As this version is serial, we are packing jobs using the __bqsub__ submission scripts, developed by the MP2 Cluster team.

- [hgt-com-raxml/timing](hgt-com-raxml/timing) contains the scripts to run TreePL and B.E.A.S.T. for time inference.
They are using our custom Java scheduler [proc-hom-ex](../../proc-hom-ex)

  



### proc_hom

This the Main project used to develop and run:

##### CHAPTER IV of Dunarel Badescu Ph.D. Thesis - UQAM 
##### Complete And Partial Horizontal Gene Transfers At The Core Of Prokaryotic Ecology And Evolution

This is heterogeneous software, using the Ruby on Rails rake build system. 
It uses an HSQLDB database, that it populates using Active Record migrations.

Simulations are run on a remote Compute Canada cluster, then results are recuperated and inserted into the database.
Following aggregation final statistics are exported from the database and graphics are drawn.




Ruby Active Record project is performing simulations of the Q-functions in various evolutionnary conditions.
It uses an [Apache Derby](http://db.apache.org/derby/) database.

It consists of Ruby scripts running in a master/slave configuration.
The controling script running on the master node is [admin/spadb.rb](admin/spadm.rb).

The simulation is also using [create_tree/createTree](create_tree/createTree) for random tree generation.
See:
- Vladimir Makarenkov and Pierre Legendre. 
Journal of Computational Biology. January 2004, 11(1): 195-212. doi:10.1089/106652704773416966. 
  * implemented by Alix Boc - June 2008.

To simulate mutated sequences along branches of the tree we used [Seqgen](http://tree.bio.ed.ac.uk/software/seqgen/).

The main program is [lib/simul_two_subtrees.rb](lib/simul_two_subtrees.rb).

The original binary Linux executable used, compiled with g++ 4.4 is [bin/q_funcb](bin/q_funcb).

### Other qfunc-cluster-simul selected contents:

  * [admin/](admin/) - Cluster task control 
  * [lib/](lib/) - Source code used for performing simulations
  * [migrate/](migrate/) - Active Record Migrations to create the database structures supporting the simulations. 
  
  
